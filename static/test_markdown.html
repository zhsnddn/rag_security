<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown å’Œæµå¼è¾“å‡ºæµ‹è¯•</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked@5.1.1/marked.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/github.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/highlight.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container mt-4">
        <h1>ğŸ§ª Markdown å’Œæµå¼è¾“å‡ºæµ‹è¯•</h1>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>æµ‹è¯•è¾“å…¥</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label>æµ‹è¯•é—®é¢˜:</label>
                            <select id="testQuestion" class="form-select">
                                <option value="ç³»ç»Ÿæœ‰å“ªäº›åŠŸèƒ½ï¼Ÿ">ç³»ç»ŸåŠŸèƒ½ä»‹ç»</option>
                                <option value="å¦‚ä½•ç®¡ç†æ–‡æ¡£ï¼Ÿ">æ–‡æ¡£ç®¡ç†æ“ä½œ</option>
                                <option value="ç³»ç»Ÿçš„å®‰å…¨ç‰¹æ€§">å®‰å…¨åŠŸèƒ½è¯´æ˜</option>
                                <option value="ç”¨æˆ·è§’è‰²å’Œæƒé™">ç”¨æˆ·ç®¡ç†</option>
                                <option value="è‡ªå®šä¹‰é—®é¢˜">è‡ªå®šä¹‰é—®é¢˜</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <input type="text" id="customQuestion" class="form-control" placeholder="è¾“å…¥è‡ªå®šä¹‰é—®é¢˜..." style="display:none;">
                        </div>
                        <button id="testBtn" class="btn btn-primary">ğŸ§ª å¼€å§‹æµ‹è¯•</button>
                        <button id="clearBtn" class="btn btn-outline-secondary ms-2">ğŸ—‘ï¸ æ¸…ç©º</button>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>æµå¼è¾“å‡ºæ•ˆæœ</h5>
                    </div>
                    <div class="card-body">
                        <div id="streamOutput" style="height: 400px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 0.375rem; padding: 1rem; background-color: #f8f9fa;">
                            <p class="text-muted">ç‚¹å‡»"å¼€å§‹æµ‹è¯•"æŸ¥çœ‹æµå¼è¾“å‡ºæ•ˆæœ...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Markdown æ¸²æŸ“æµ‹è¯•</h5>
                    </div>
                    <div class="card-body">
                        <textarea id="markdownInput" class="form-control mb-3" rows="6" placeholder="è¾“å…¥Markdownå†…å®¹è¿›è¡Œæµ‹è¯•...">## ğŸ¯ Markdown æµ‹è¯•

### åŠŸèƒ½ç‰¹æ€§
- **ç²—ä½“æ–‡å­—**
- *æ–œä½“æ–‡å­—*
- `è¡Œå†…ä»£ç `

### ä»£ç å—
```javascript
console.log("Hello, Markdown!");
```

### å¼•ç”¨
> è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨ç¤ºä¾‹

### è¡¨æ ¼
| åŠŸèƒ½ | çŠ¶æ€ |
|------|------|
| Markdown | âœ… |
| æµå¼è¾“å‡º | âœ… |</textarea>
                        <button id="renderBtn" class="btn btn-success">ğŸ¨ æ¸²æŸ“é¢„è§ˆ</button>
                        <div id="markdownOutput" class="mt-3 p-3 border rounded bg-white"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æµ‹è¯•é—®é¢˜é€‰æ‹©
        document.getElementById('testQuestion').addEventListener('change', function() {
            const customInput = document.getElementById('customQuestion');
            if (this.value === 'è‡ªå®šä¹‰é—®é¢˜') {
                customInput.style.display = 'block';
                customInput.focus();
            } else {
                customInput.style.display = 'none';
            }
        });

        // æµ‹è¯•æµå¼è¾“å‡º
        document.getElementById('testBtn').addEventListener('click', async function() {
            const select = document.getElementById('testQuestion');
            const customInput = document.getElementById('customQuestion');
            const question = select.value === 'è‡ªå®šä¹‰é—®é¢˜' ? customInput.value : select.value;
            
            if (!question || question === 'è‡ªå®šä¹‰é—®é¢˜') {
                alert('è¯·é€‰æ‹©æˆ–è¾“å…¥ä¸€ä¸ªé—®é¢˜');
                return;
            }

            const output = document.getElementById('streamOutput');
            output.innerHTML = '';
            
            try {
                // æ¨¡æ‹Ÿæµå¼è¾“å‡º
                const messages = [
                    { type: 'thinking', message: 'ğŸ” æ­£åœ¨åˆ†æé—®é¢˜...' },
                    { type: 'thinking', message: 'ğŸ“– æ£€ç´¢ç›¸å…³æ–‡æ¡£...' },
                    { type: 'thinking', message: 'ğŸ¤” ç”Ÿæˆå›ç­”...' },
                    { type: 'answer_start', message: '' }
                ];

                // æ¨¡æ‹Ÿæ€è€ƒè¿‡ç¨‹
                for (const msg of messages.slice(0, 3)) {
                    addThinkingMessage(output, msg.message);
                    await sleep(800);
                }

                // å¼€å§‹ç­”æ¡ˆè¾“å‡º
                const answerDiv = document.createElement('div');
                answerDiv.className = 'answer-content mt-3';
                output.appendChild(answerDiv);

                // æ¨¡æ‹Ÿç­”æ¡ˆ - ä½¿ç”¨åç«¯çš„æ¨¡æ‹Ÿå›ç­”æ ¼å¼
                let answer = getSimulateAnswer(question);
                
                // é€å¥è¾“å‡º
                const sentences = answer.split('\n');
                for (let i = 0; i < sentences.length; i++) {
                    const currentContent = sentences.slice(0, i + 1).join('\n');
                    try {
                        answerDiv.innerHTML = marked.parse(currentContent);
                        answerDiv.querySelectorAll('pre code').forEach(block => {
                            hljs.highlightElement(block);
                        });
                    } catch (e) {
                        answerDiv.innerHTML = currentContent.replace(/\n/g, '<br>');
                    }
                    output.scrollTop = output.scrollHeight;
                    await sleep(200);
                }

            } catch (error) {
                output.innerHTML = `<div class="alert alert-danger">æµ‹è¯•é”™è¯¯: ${error.message}</div>`;
            }
        });

        // æ¸…ç©ºè¾“å‡º
        document.getElementById('clearBtn').addEventListener('click', function() {
            document.getElementById('streamOutput').innerHTML = '<p class="text-muted">ç‚¹å‡»"å¼€å§‹æµ‹è¯•"æŸ¥çœ‹æµå¼è¾“å‡ºæ•ˆæœ...</p>';
        });

        // Markdown æ¸²æŸ“æµ‹è¯•
        document.getElementById('renderBtn').addEventListener('click', function() {
            const input = document.getElementById('markdownInput').value;
            const output = document.getElementById('markdownOutput');
            
            try {
                output.innerHTML = marked.parse(input);
                output.querySelectorAll('pre code').forEach(block => {
                    hljs.highlightElement(block);
                });
            } catch (e) {
                output.innerHTML = `<div class="alert alert-danger">æ¸²æŸ“é”™è¯¯: ${e.message}</div>`;
            }
        });

        function addThinkingMessage(container, message) {
            const div = document.createElement('div');
            div.className = 'thinking-indicator mb-2';
            div.innerHTML = `
                <div class="spinner-border spinner-border-sm text-primary me-2" role="status"></div>
                <span>${message}</span>
            `;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function getSimulateAnswer(question) {
            const q = question.toLowerCase();
            
            if (q.includes('åŠŸèƒ½') || q.includes('ç³»ç»Ÿ')) {
                return `## ğŸ¤– RAGæ™ºèƒ½æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ

### ç³»ç»Ÿæ¦‚è¿°
æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäº**æ£€ç´¢å¢å¼ºç”Ÿæˆ(RAG)**æŠ€æœ¯çš„æ™ºèƒ½æ–‡æ¡£ç®¡ç†å¹³å°ã€‚

### æ ¸å¿ƒåŠŸèƒ½

#### 1. æ™ºèƒ½é—®ç­” ğŸ§ 
- **å®æ—¶æµå¼è¾“å‡º**ï¼šæ¨¡æ‹ŸçœŸå®AIæ€è€ƒè¿‡ç¨‹
- **Markdownæ¸²æŸ“**ï¼šæ”¯æŒå¯Œæ–‡æœ¬æ ¼å¼æ˜¾ç¤º
- **æ–‡æ¡£æ£€ç´¢**ï¼šåŸºäºä¸Šä¼ æ–‡æ¡£å†…å®¹å›ç­”é—®é¢˜

#### 2. æ–‡æ¡£ç®¡ç† ğŸ“š
- å¤šæ ¼å¼æ–‡æ¡£æ”¯æŒ
- å®‰å…¨åˆ†çº§å­˜å‚¨
- å®æ—¶æ–‡æ¡£åˆ—è¡¨

### ç‰¹è‰²åŠŸèƒ½
- âœ¨ **æµå¼è¾“å‡º**ï¼šå®æ—¶æ˜¾ç¤ºAIæ€è€ƒè¿‡ç¨‹
- ğŸ¨ **Markdownæ”¯æŒ**ï¼šç¾è§‚çš„å¯Œæ–‡æœ¬æ¸²æŸ“
- ğŸ” **å®‰å…¨å¯é **ï¼šä¼ä¸šçº§å®‰å…¨ä¿éšœ`;
            } else {
                return `## ğŸ’¬ æµ‹è¯•å›ç­”

æ„Ÿè°¢æ‚¨çš„é—®é¢˜ï¼š**${question}**

è¿™æ˜¯ä¸€ä¸ª **Markdown æ ¼å¼** çš„æµ‹è¯•å›ç­”ï¼ŒåŒ…å«ï¼š

### åŠŸèƒ½ç‰¹æ€§
- æ”¯æŒ \`ä»£ç é«˜äº®\`
- æ”¯æŒ **ç²—ä½“** å’Œ *æ–œä½“*
- æ”¯æŒåˆ—è¡¨å’Œè¡¨æ ¼

### ä»£ç ç¤ºä¾‹
\`\`\`javascript
function testMarkdown() {
    console.log("Markdownæ¸²æŸ“æµ‹è¯•");
}
\`\`\`

> è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨å—ç¤ºä¾‹

---
*æµ‹è¯•å®Œæˆï¼*`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ¸²æŸ“Markdownç¤ºä¾‹
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('renderBtn').click();
        });
    </script>
</body>
</html> 